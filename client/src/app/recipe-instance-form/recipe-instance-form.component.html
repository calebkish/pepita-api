<div *appBe="state.select() | async as vm" class="p-5">

  <div class="grid grid-cols-12 gap-8">
    <div class="w-full col-span-7 pb-96">

      <div class="flex justify-between items-center">
        <h1 class="text-3xl font-bold text-gray-800 mb-5">
          {{ vm?.formMode === 'create' ? 'Create recipe instance': 'Edit recipe instance' }}
        </h1>

        <button
          *ngIf="vm?.formMode === 'edit'"
          (click)="onDeleteRecipe$.next()"
          title="Add serving unit"
          class="bg-red-200 text-red-700 rounded-full px-4 py-2 text-bold text-sm active:bg-red-300 transition-all active:scale-95 w-fit flex items-center gap-1"
          type="button"
        >
          <span class="material-symbols-outlined">delete</span>
          Delete recipe instance
        </button>
      </div>

      <form (ngSubmit)="onSubmit$.next()" [formGroup]="form">
        <div class="flex flex-col gap-3">
          <app-text-input label="Name" formCtrlName="name" [disabled]="true" />

          <div class="flex flex-col gap-3 pb-10">
            <p class="text-2xl font-bold text-slate-700">Ingredients</p>
            <div class="pl-4">
              <app-foods-on-recipe-form
                [parent]="form"
                [showScaledToRecipe]="true"
                [disableBaseInputs]="true"
                [disableCreateDelete]="true"
                [disableScaleChanging]="true"
              />
            </div>
          </div>

          <div class="flex flex-col gap-3 pb-7">
            <p class="text-2xl font-bold text-slate-700">Directions</p>
            <div class="pl-4">
              <app-recipe-directions [readonly]="true" [parent]="form" />
            </div>
          </div>

        </div>

        <div class="flex">
          <app-submit-button [label]="vm?.formMode === 'create' ? 'Create' : 'Apply edit'" />
        </div>

      </form>
    </div>

    <div class="col-span-5 mx-auto relative">
      <app-nutrients
        *ngIf="vm?.recipeNutrients as nutrients"
        [nutrients]="nutrients"
        class="sticky top-0"
      />
    </div>

  </div>
</div>
